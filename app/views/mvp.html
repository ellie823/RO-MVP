<div ng-controller="MvpCtrl">
    <div class="input-group mvp-filter pull-right">
        <input type="text" class="form-control form-control-sm" placeholder="Search" ng-class="{'rounded': !mvpFilter}" ng-model="mvpFilter">
        <span class="input-group-btn" ng-show="mvpFilter">
            <button class="btn btn-default" type="button" ng-click="mvpFilter=''">
                <span class="glyphicon glyphicon-remove"></span>
            </button>
        </span>
    </div>
    <table class="table table-striped mvpList">
        <thead>
            <tr>
                <td width="40%">MVP</td>
                <td width="30%">Spawn Time</td>
                <td width="30%">Update</td>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="mvp in (mvpList | filter:mvpFilter)" mvp="mvp" state="state">
                <td>
                    <div><span class="mvp-name">{{mvp.name}}</span> <small>({{mvp.map}})</small></div>
                    <div><small>{{mvp.respawn.min / 60 | number:0}} â€“ {{mvp.respawn.max / 60 | number:0}} Minutes</small></div>
                </td>
                <td>
                    <div ng-if="mvp.$track.$valid">
                        <div>
                            <span>{{state ? '' : 'in'}}</span>
                            <strong>
                                <span ng-class="mvp.$track.$respawn.min > 0 ? 'text-success' : 'text-danger'">
                                    {{state ? (((-1 * mvp.$track.$respawn.min) / 60) | number:0) : ((mvp.$track.$respawn.min / 60) | number:0)}}
                                </span>
                            </strong>
                            minutes to
                            <strong>
                                <span ng-class="mvp.$track.$respawn.max > 0 ? 'text-success' : 'text-danger'">
                                    {{state ? (((-1 * mvp.$track.$respawn.max) / 60) | number:0) : ((mvp.$track.$respawn.max / 60) | number:0)}}
                                </span>
                            </strong>
                            minutes
                            <span>{{state ? 'ago' : ''}}</span>
                        </div>
                        <div>last tracked <span am-time-ago="mvp.$track.time * 1000"></span> by <strong>{{mvp.$track.name}}</strong></div>
                    </div>
                </td>
                <td>
                    <div class="input-group input-group-sm group-track">
                        <input type="text" class="form-control form-control-sm" ng-init="ago=0" ng-blur="!ago ? ago=0 : ago=ago" ng-model="ago">
                        <span class="ago"></span>
                        <span class="input-group-btn">
                            <button class="btn btn-default btn-sm" type="button" ng-click="setTrack(mvp, ago * 60)">
                                <span class="glyphicon glyphicon-share-alt"></span>
                            </button>
                        </span>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
